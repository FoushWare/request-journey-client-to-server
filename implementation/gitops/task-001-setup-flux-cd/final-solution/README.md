# Final Solution: Flux CD Setup

This directory contains the complete solution for setting up Flux CD to manage Notes App deployments.

## Structure

```
final-solution/
├── clusters/
│   └── dev/
│       ├── flux-system/
│       │   └── gotk-components.yaml  # Flux system components
│       └── apps/
│           └── notes-app/
│               ├── kustomization.yaml      # Kustomize config
│               ├── flux-kustomization.yaml # Flux Kustomization resource
│               └── ingress.yaml            # Ingress configuration
└── README.md (this file)
```

## Key Files

### `clusters/dev/flux-system/gotk-components.yaml`
- GitRepository source pointing to your Git repo
- Flux system Kustomization
- Auto-generated by `flux bootstrap` command

### `clusters/dev/apps/notes-app/kustomization.yaml`
- Kustomize configuration for Notes App
- References base manifests
- Sets environment-specific values (replicas, image tags, labels)

### `clusters/dev/apps/notes-app/flux-kustomization.yaml`
- Flux Kustomization resource
- Tells Flux to sync this path
- Includes health checks for deployments

## How to Use

1. **Bootstrap Flux** (one-time setup):
   ```bash
   flux bootstrap github \
     --owner=FoushWare \
     --repository=request-journey-client-to-server \
     --branch=main \
     --path=clusters/dev \
     --personal
   ```

2. **Apply Kustomization**:
   ```bash
   kubectl apply -f clusters/dev/apps/notes-app/flux-kustomization.yaml
   ```

3. **Verify**:
   ```bash
   flux get kustomizations
   kubectl get pods -n notes-app
   ```

## Notes

- Flux watches the Git repository every 5 minutes (configurable)
- Changes in Git are automatically applied to the cluster
- Manual `kubectl` changes will be reverted by Flux (if prune is enabled)
- All changes should be made via Git commits

